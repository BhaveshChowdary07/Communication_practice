{% if section.type == 'story_retelling' %}
<div class="container py-4">
  <h2 class="text-center fw-semibold mb-2 text-purple">Story Retelling</h2>
  <p class="text-center text-muted mb-4">Listen to the story and retell it in your own words.</p>

  <!-- Hidden Audio Upload -->
  <input type="file" name="audio_response_{{ q.id }}" id="audio_input_{{ q.id }}" accept="audio/wav" hidden>

  <div class="d-flex flex-wrap gap-4">
    <div class="flex-fill instruction-box" style="min-width: 280px;">
      <h5 class="fw-semibold mb-3">Instructions</h5>
      <ul class="ps-3">
        <li>Click "Play Audio" to listen to the story.</li>
        <li>Understand the main idea and flow of events.</li>
        <li>Click "Start Recording" to retell the story.</li>
        <li>Speak in your own words clearly.</li>
        <li>You will get only one attempt.</li>
      </ul>
    </div>

    <div class="flex-fill interaction-box" style="min-width: 280px;">
      <h6 class="fw-semibold mb-2">Listen and Retell:</h6>
      <div class="mb-3">
        <button type="button" class="gradient-play-btn" onclick="playAudio({{ q.id }})">
          ‚ñ∂ Play Audio
        </button>
      </div>
      <button type="button" class="gradient-play-btn" onclick="toggleRecording({{ q.id }}, this)">
        üéôÔ∏è Start Recording
      </button>
    </div>
  </div>
</div>
{% endif %}
